<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Chamber — Home</title>
    <meta name="description" content="Chamber of Commerce — Home" />

    <style>
        :root{
            --brand:#0d6efd;
            --accent:#ff7a18;
            --bg:#f7f8fb;
            --text:#222;
            --card:#fff;
            --max-width:1100px;
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
            color:var(--text);
            background:var(--bg);
            line-height:1.4;
        }
        header{
            background:linear-gradient(90deg,var(--brand),#6fb1ff);
            color:white;
            padding:1rem;
        }
        .container{max-width:var(--max-width);margin:0 auto;padding:0 1rem;}
        .top{
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:1rem;
        }
        nav a{
            color:white;text-decoration:none;margin-left:1rem;font-weight:600;
        }
        .hero{
            display:grid;
            grid-template-columns:1fr;
            gap:1rem;
            align-items:center;
            margin:1rem auto;
            max-width:var(--max-width);
            padding:0 1rem;
        }
        .hero-card{
            background:linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
            padding:2rem;
            border-radius:10px;
            color:white;
            display:flex;
            gap:1rem;
            align-items:center;
            justify-content:space-between;
        }
        .hero-card img{
            width:48%;
            height:auto;
            border-radius:8px;
            object-fit:cover;
            display:block;
        }
        .cta{
            display:inline-block;
            background:var(--accent);
            color:white;
            padding:.75rem 1rem;
            border-radius:8px;
            text-decoration:none;
            font-weight:700;
            margin-top:.75rem;
        }

        main{
            max-width:var(--max-width);
            margin:1rem auto;
            padding:0 1rem 3rem;
            display:grid;
            gap:1rem;
        }

        .grid{
            display:grid;
            gap:1rem;
        }

        .events, .weather, .spotlights{
            background:var(--card);
            padding:1rem;
            border-radius:10px;
            box-shadow:0 2px 6px rgba(20,20,30,0.06);
        }

        .events ul{margin:0;padding:0 0 0 1.25rem}
        .spotlight-cards{
            display:grid;
            gap:1rem;
            grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
        }
        .spot{
            padding:1rem;
            border-radius:8px;
            background:linear-gradient(180deg,#fff,#fbfbff);
            display:flex;
            gap:.75rem;
            align-items:center;
        }
        .logo{
            width:72px;height:72px;border-radius:6px;object-fit:contain;background:#fff;padding:6px;border:1px solid #eee;
        }
        footer{
            background:#111827;color:white;padding:1rem 0;margin-top:2rem;
        }

        /* responsive layout: stack on small screens; side-by-side on wider */
        @media(min-width:800px){
            .hero{grid-template-columns:1fr;}
            main{grid-template-columns: 2fr 1fr;}
            .grid{grid-template-rows:auto}
        }

        @media(min-width:1100px){
            .hero-card img{width:40%}
        }
    </style>
</head>
<body>
    <header>
        <div class="container top">
            <div>
                <h1 style="margin:.1rem 0;">Townsville Chamber</h1>
                <div style="opacity:.95;font-size:.95rem">Supporting local business & community</div>
            </div>
            <nav aria-label="Main navigation">
                <a href="index.html">Home</a>
                <a href="directory.html">Directory</a>
                <a href="events.html">Events</a>
                <a href="join.html">Join</a>
            </nav>
        </div>
    </header>

    <section class="hero" aria-labelledby="hero-title">
        <div class="hero-card container" role="region" aria-label="Welcome hero">
            <div style="flex:1">
                <h2 id="hero-title" style="margin:0 0 .25rem;">Welcome to the Townsville Chamber</h2>
                <p style="margin:.25rem 0 .5rem;opacity:.95;">Connecting local businesses with residents, visitors, and each other. Explore our members, upcoming events, and learn how to join.</p>
                <a class="cta" href="join.html">Join the Chamber</a>
            </div>
            <img src="images/hero.jpg" alt="Downtown street with banners" />
        </div>
    </section>

    <main>
        <div class="grid">
            <section class="events" aria-labelledby="events-heading">
                <h3 id="events-heading">Current Events</h3>
                <p>Upcoming community events — join us!</p>
                <ul>
                    <li><strong>Farmers Market</strong> — Saturdays, 9am–1pm at Main Plaza</li>
                    <li><strong>Business Mix & Mingle</strong> — 2nd Thursday, 5:30pm at Town Hall</li>
                    <li><strong>Summer Concert Series</strong> — Sundays in July, Riverside Park</li>
                </ul>
            </section>

            <section class="spotlights" aria-labelledby="spotlight-heading">
                <h3 id="spotlight-heading">Member Spotlights</h3>
                <div id="spotlightContainer" class="spotlight-cards" aria-live="polite">
                    <!-- spotlight cards inserted by JS -->
                </div>
            </section>
        </div>

        <aside class="weather" aria-labelledby="weather-heading">
            <h3 id="weather-heading">Current Weather</h3>
            <div id="weatherNow">
                <p>Loading weather...</p>
            </div>

            <h4 style="margin-top:.75rem">3-Day Forecast</h4>
            <div id="forecast" style="display:flex;gap:.5rem;flex-wrap:wrap"></div>
        </aside>
    </main>

    <footer>
        <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap">
            <small>&copy; <span id="year"></span> Townsville Chamber</small>
            <nav><a href="privacy.html" style="color:#ddd;text-decoration:none;margin-left:.75rem">Privacy</a></nav>
        </div>
    </footer>

    <script>
        // Config: set your OpenWeatherMap API key and chamber location (lat/lon).
        const OWM_API_KEY = 'REPLACE_WITH_YOUR_API_KEY';
        const LAT = 47.657;   // example: Preston/Idaho coordinates - replace as needed
        const LON = -111.876;

        // Utility: select random N elements from array
        function pickRandom(arr, n){
            const copy = arr.slice();
            const result = [];
            while(result.length < n && copy.length){
                const i = Math.floor(Math.random() * copy.length);
                result.push(copy.splice(i,1)[0]);
            }
            return result;
        }

        // Weather: fetch and render current + 3-day forecast using One Call API (v2.5)
        async function loadWeather(){
            try{
                if(!OWM_API_KEY || OWM_API_KEY === 'REPLACE_WITH_YOUR_API_KEY'){
                    document.getElementById('weatherNow').innerHTML = '<p>Please set your OpenWeatherMap API key in the script to load real weather.</p>';
                    return;
                }
                const url = `https://api.openweathermap.org/data/2.5/onecall?lat=${LAT}&lon=${LON}&exclude=minutely,hourly,alerts&units=imperial&appid=${OWM_API_KEY}`;
                const res = await fetch(url);
                if(!res.ok) throw new Error('Weather fetch failed');
                const data = await res.json();

                // current
                const cur = data.current;
                const nowHTML = `
                    <p style="margin:.25rem 0"><strong>${Math.round(cur.temp)}°F</strong> — ${cur.weather[0].description}</p>
                    <p style="margin:.25rem 0;opacity:.85">Feels like ${Math.round(cur.feels_like)}°F • Humidity ${cur.humidity}%</p>
                `;
                document.getElementById('weatherNow').innerHTML = nowHTML;

                // 3-day forecast (skip today, use next 3 days)
                const forecastEl = document.getElementById('forecast');
                forecastEl.innerHTML = '';
                const days = data.daily.slice(1,4); // next 3 days
                days.forEach(d => {
                    const date = new Date(d.dt * 1000);
                    const label = date.toLocaleDateString(undefined, {weekday:'short',month:'short',day:'numeric'});
                    const card = document.createElement('div');
                    card.style.background = '#fff';
                    card.style.padding = '.5rem';
                    card.style.borderRadius = '8px';
                    card.style.minWidth = '110px';
                    card.style.boxShadow = '0 1px 3px rgba(0,0,0,0.06)';
                    card.innerHTML = `
                        <div style="font-weight:700">${label}</div>
                        <div style="font-size:1.05rem;margin:.25rem 0">${Math.round(d.temp.day)}°F</div>
                        <div style="opacity:.85;font-size:.95rem">${d.weather[0].main}</div>
                    `;
                    forecastEl.appendChild(card);
                });

            }catch(err){
                console.error(err);
                document.getElementById('weatherNow').innerHTML = '<p>Unable to load weather at this time.</p>';
            }
        }

        // Spotlights: load members.json, pick 2 or 3 gold/silver members at random and render
        async function loadSpotlights(){
            try{
                const res = await fetch('data/members.json');
                if(!res.ok) throw new Error('Members fetch failed');
                const json = await res.json();
                const members = json.members || [];
                const eligible = members.filter(m => {
                    const level = (m.membership || '').toLowerCase();
                    return level === 'gold' || level === 'silver';
                });
                if(!eligible.length){
                    document.getElementById('spotlightContainer').innerHTML = '<p>No eligible members found.</p>';
                    return;
                }
                const count = Math.min(3, Math.max(2, Math.floor(Math.random() * 2) + 2)); // 2 or 3
                const picks = pickRandom(eligible, count);
                const container = document.getElementById('spotlightContainer');
                container.innerHTML = '';
                for(const m of picks){
                    const card = document.createElement('div');
                    card.className = 'spot';
                    card.innerHTML = `
                        <img class="logo" src="${m.logo || 'images/logo-placeholder.png'}" alt="${m.name} logo" />
                        <div style="flex:1">
                            <div style="font-weight:700">${m.name}</div>
                            <div style="font-size:.95rem;color:#444;margin:.25rem 0">${m.address || ''}</div>
                            <div style="font-size:.95rem;opacity:.85">${m.phone || ''}</div>
                            <div style="margin-top:.35rem"><a href="${m.website || '#'}" target="_blank" rel="noopener" style="color:var(--brand);text-decoration:none;font-weight:600">${m.website ? 'Visit website' : ''}</a></div>
                            <div style="margin-top:.3rem;font-size:.8rem;color:#666">Member: ${m.membership}</div>
                        </div>
                    `;
                    container.appendChild(card);
                }
            }catch(err){
                console.error(err);
                document.getElementById('spotlightContainer').innerHTML = '<p>Unable to load member spotlights.</p>';
            }
        }

        // initialize
        document.getElementById('year').textContent = new Date().getFullYear();
        loadWeather();
        loadSpotlights();
    </script>
</body>
</html>